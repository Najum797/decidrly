<!DOCTYPE html>
<html>
<head>
<title>Rent vs Buy Calculator | Decidrly</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial;
  max-width: 600px;
  margin: auto;
  padding: 20px;
}

input, select {
  width: 100%;
  padding: 10px;
  margin: 5px 0 15px 0;
  font-size: 16px;
}

button {
  padding: 12px;
  width: 100%;
  background-color: #2c7be5;
  color: white;
  border: none;
  font-size: 16px;
  cursor: pointer;
}

.result {
  margin-top: 20px;
  font-weight: bold;
  font-size: 18px;
}
</style>

</head>

<body>

<h2>Rent vs Buy Calculator</h2>

<label>Select Country</label>
<select id="country" onchange="changeCountry()">

<option value="USD">United States (USD)</option>
<option value="PKR">Pakistan (PKR)</option>
<option value="GBP">United Kingdom (GBP)</option>
<option value="AED">UAE (AED)</option>
<option value="SAR">Saudi Arabia (SAR)</option>
<option value="CAD">Canada (CAD)</option>
<option value="AUD">Australia (AUD)</option>
<option value="EUR">European Union (EUR)</option>

</select>

<label>Monthly Rent</label>
<input id="rent" type="text" oninput="formatInput(this)">

<label>House Price</label>
<input id="price" type="text" oninput="formatInput(this)">

<label>Years</label>
<input id="years" type="number">

<button onclick="calculate()">Calculate</button>

<div class="result" id="result"></div>

<script>

let userCurrency = "USD";
let userLocale = "en-US";
let exchangeRates = {};
let originalCurrency = "USD";

// country â†’ locale mapping
const countryLocale = {

  USD: "en-US",
  PKR: "en-PK",
  GBP: "en-GB",
  AED: "en-AE",
  SAR: "en-SA",
  CAD: "en-CA",
  AUD: "en-AU",
  EUR: "en-DE"

};

// Detect user's country automatically
function detectUserCountry() {

  let locale = Intl.NumberFormat().resolvedOptions().locale;

  if(locale.includes("PK")) userCurrency = "PKR";
  else if(locale.includes("GB")) userCurrency = "GBP";
  else if(locale.includes("AE")) userCurrency = "AED";
  else if(locale.includes("SA")) userCurrency = "SAR";
  else if(locale.includes("CA")) userCurrency = "CAD";
  else if(locale.includes("AU")) userCurrency = "AUD";
  else if(locale.includes("DE") || locale.includes("FR")) userCurrency = "EUR";
  else userCurrency = "USD";

  originalCurrency = userCurrency;

  document.getElementById("country").value = userCurrency;

}

// Load live exchange rates
async function loadRates() {

  try {

    const response = await fetch("https://api.exchangerate-api.com/v4/latest/USD");

    const data = await response.json();

    exchangeRates = data.rates;

  }
  catch {

    exchangeRates = {
      USD:1,
      PKR:280,
      GBP:0.78,
      AED:3.67,
      SAR:3.75,
      CAD:1.35,
      AUD:1.5,
      EUR:0.92
    };

  }

}

// Format input commas
function formatInput(input) {

  let value = input.value.replace(/[^\d]/g,'');

  if(value === '') return;

  input.value = Number(value).toLocaleString(userLocale);

}

// Get number
function getNumber(id) {

  return Number(document.getElementById(id).value.replace(/,/g,''));

}

// Convert currency
function convertCurrency(amount) {

  let usdValue = amount / exchangeRates[originalCurrency];

  return usdValue * exchangeRates[userCurrency];

}

// Format currency display
function formatCurrency(amount) {

  return new Intl.NumberFormat(countryLocale[userCurrency], {

    style: 'currency',
    currency: userCurrency,
    maximumFractionDigits: 0

  }).format(amount);

}

// Change country manually
function changeCountry() {

  userCurrency = document.getElementById("country").value;

}

// Calculate
function calculate() {

  let rent = getNumber("rent");
  let price = getNumber("price");
  let years = Number(document.getElementById("years").value);

  let totalRent = rent * 12 * years;

  let difference;

  if(totalRent > price)
    difference = totalRent - price;
  else
    difference = price - totalRent;

  let converted = convertCurrency(difference);

  if(totalRent > price)
    result.innerHTML =
      "Buying is better by " + formatCurrency(converted);
  else
    result.innerHTML =
      "Renting is better by " + formatCurrency(converted);

}

// Initialize
detectUserCountry();
loadRates();

</script>

</body>
</html>
